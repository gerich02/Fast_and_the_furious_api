# FastAPI проект Fast_and_the_furious_api
## Доступ к документации Swagger по ссылке:
##### [/docs - Вернёт документацию в UI Swagger](http://127.0.0.1:8000/docs)

FastAPI проект Fast_and_the_furious_api

## Стек технологий
- FastAPI - для создания высокоскоростных RESTful API.
- SQLAlchemy - ORM для работы с базами данных.
- Pydantic - для валидации данных и работы с типами данных.
- Uvicorn - ASGI сервер для запуска FastAPI приложений.
- Python-dotenv - для работы с конфигурационными файлами .env.
- python-jose - для работы с JWT-токенами.
- Passlib - для безопасной хеширования паролей.
- aiofiles - для асинхронной работы с файлами.
- aiosqlite - асинхронный драйвер SQLite.
- Pillow - для обработки изображений (например, водяных знаков).
- Black - для автоматического форматирования кода.

## Запуск проекта в dev-режиме

- Склонируйте репозиторий:  
``` git@github.com:gerich02/Fast_and_the_furious_api.git ```    
- Установите и активируйте виртуальное окружение:  
``` python -m venv venv ```  
``` source venv/Scripts/activate ``` 
- Установите зависимости из файла requirements.txt:   
``` pip install -r requirements.txt ```
- Создайте .env файл конфигурации переменных окружения:
```
SECRET_KEY="jNw8K1X5M6iZLOHqTPFf9VG62RiKmaBv17_plgfZQ_8" # пример секретного ключа для генерации JWT
LIMIT_PER_DAY = 5 # лимит на голосование в день
```
- Перейдите в папку /Fast_and_the_furious_api/app.
- Выполните команду:   
``` uvicorn main:app --reload ```

## Возможности приложения
- регистрация клиента приложения осуществляется с добавлением в базу данных
почты(уникальное поле для всей базы данных), пароля, имени, фамилии, аватарки,
долготы и широты геопозиции;
- в момент регистрации на аватарку клинета накладывается watermark из директории
/static, в нёё же сохраняется изменённая аватарка. Функция наложения выполняется при
помощи библиотеки Pillow, выполняется асинхронно, не блокируя основной поток выполнения
программы. Достигается это за счет добавления этой задачи в Background Tasks - встроенный
в FastAPI инструмент для асинхронного выполнения задач;
- так же реализована процедура JWT аутентификации по почте и паролю;
- реализован механизм голосования пользователей друг за друга, настроен лимит
голосований в день (LIMIT_PER_DAY), а так же при взаимной симпатии имитируется
отправка сообщения обоим участникам "Вы понравились {имя участника}!
Почта участника: {почта}";
- так же реализован функционал получения списка клиентов приложения с фильтрацией
по полу, имени, фамилии, дате регистрации и удаленности от аутентифицированного
в данный момент пользователя. Реализуется последний пункт за счет Great-circle distance
формулы. Благодаря методу lru_cache из встроенной библиотеки functools мы кэшируем
вычисления расстояния для улучшения производительности приложения.
- так же благодаря JWT аутентификации реализовано ограничение, при котором
обновить данные клиента (PUT запрос) и  удалить (DELETE) может только сам
пользователь, а проголосовать - только аутентифицированный пользователь.

## Примеры запросов к приложению

- ``` /api/clients/create ``` # создание пользователя
- ``` /api/clients/{id} ``` # В звисимости от запрсоа (GET, PUT, DELETE) получение, изменение или удаления пользователя
- ``` /api/clients ``` # получение списка пользователей
- ``` /api/clients/{id}/match``` # голосование за пользователя с id = {id}

## Дорожная карта будующих обновлений
В планах нашей команды добавить:
- поддержку автотестов;
- отправку email через боевой почтовый сервер (как только наш Devops вспомнит пароль от почты)
- валидация данных посредством регулярных выражений (re)
- переход на PosgreSQL
- настройка alembic для миграций базы данных
и многое другое...

## Об авторе
- [Варивода Георгий](https://github.com/gerich02)